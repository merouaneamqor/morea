{%- comment -%}
  Instagram Testimonials
  Allows uploading Instagram conversation screenshots as social proof.
{%- endcomment -%}

<section class="section section-{{ section.id }}-padding gradient color-{{ section.settings.color_scheme }}">
  {{ 'section-instagram-testimonials.css' | asset_url | stylesheet_tag }}

  {%- style -%}
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
      padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
    }

    @media screen and (min-width: 750px) {
      .section-{{ section.id }}-padding {
        padding-top: {{ section.settings.padding_top }}px;
        padding-bottom: {{ section.settings.padding_bottom }}px;
      }
    }
  {%- endstyle -%}

  <div class="page-width instagram-testimonials instagram-testimonials--cols-{{ section.settings.columns_desktop }}">
    {%- if section.settings.heading != blank or section.settings.subheading != blank -%}
      <div class="instagram-testimonials__header">
        {%- if section.settings.heading != blank -%}
          <h2 class="h2">{{ section.settings.heading | escape }}</h2>
        {%- endif -%}
        {%- if section.settings.subheading != blank -%}
          <div class="rte instagram-testimonials__subheading">{{ section.settings.subheading }}</div>
        {%- endif -%}
      </div>
    {%- endif -%}

    <ul class="instagram-testimonials__grid" role="list">
      {%- for block in section.blocks -%}
        {%- if block.type == 'screenshot' -%}
          <li class="instagram-testimonials__item" {{ block.shopify_attributes }}>
            {%- if block.settings.image != blank -%}
              <div class="instagram-testimonials__card">
                <img
                  srcset="
                    {{ block.settings.image | image_url: width: 320 }} 320w,
                    {{ block.settings.image | image_url: width: 640 }} 640w,
                    {{ block.settings.image | image_url: width: 960 }} 960w,
                    {{ block.settings.image | image_url: width: 1280 }} 1280w
                  "
                  sizes="(min-width: 990px) 33vw, (min-width: 750px) 50vw, 100vw"
                  src="{{ block.settings.image | image_url: width: 960 }}"
                  width="{{ block.settings.image.width }}"
                  height="{{ block.settings.image.height }}"
                  alt="{{ block.settings.alt_text | escape | default: 'Instagram testimonial screenshot' }}"
                  loading="lazy"
                >
              </div>
            {%- endif -%}
          </li>
        {%- endif -%}
      {%- endfor -%}
    </ul>
  </div>
</section>

{% schema %}
{
  "name": "Instagram testimonials",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Loved by our community"
    },
    {
      "type": "richtext",
      "id": "subheading",
      "label": "Subheading",
      "default": "<p>Real conversations from Instagram customers.<\/p>"
    },
    {
      "type": "select",
      "id": "columns_desktop",
      "label": "Columns on desktop",
      "options": [
        { "value": "2", "label": "2" },
        { "value": "3", "label": "3" },
        { "value": "4", "label": "4" }
      ],
      "default": "3"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 36
    }
  ],
  "blocks": [
    {
      "type": "screenshot",
      "name": "Screenshot",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Instagram screenshot"
        },
        {
          "type": "text",
          "id": "alt_text",
          "label": "Alt text",
          "default": "Instagram testimonial screenshot"
        }
      ]
    }
  ],
  "max_blocks": 12,
  "presets": [
    {
      "name": "Instagram testimonials",
      "category": "Testimonials",
      "blocks": [
        { "type": "screenshot" },
        { "type": "screenshot" },
        { "type": "screenshot" }
      ]
    }
  ]
}
{% endschema %}


