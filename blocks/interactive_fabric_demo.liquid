{% doc %}
  Interactive Fabric Demo Block

  A custom liquid section demonstrating advanced functionality:
  - Interactive fabric swatches with hover effects
  - Dynamic content loading
  - Custom JavaScript for enhanced UX
  - CSS animations and transitions
  - Responsive design with fallbacks
{% enddoc %}

{% assign demo_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .fabric-demo-{{ demo_id }} {
    background: {{ block.settings.background_color }};
    padding: {{ block.settings.padding }}px 20px;
    position: relative;
    overflow: hidden;
  }

  .fabric-demo-container-{{ demo_id }} {
    max-width: {{ block.settings.max_width }}px;
    margin: 0 auto;
    position: relative;
    z-index: 2;
  }

  .fabric-demo-header-{{ demo_id }} {
    text-align: center;
    margin-bottom: {{ block.settings.section_spacing }}px;
  }

  .fabric-demo-title-{{ demo_id }} {
    font-size: {{ block.settings.title_size }}px;
    font-weight: {{ block.settings.title_weight }};
    color: {{ block.settings.title_color }};
    margin: 0 0 {{ block.settings.content_spacing }}px 0;
    line-height: 1.3;
  }

  .fabric-demo-subtitle-{{ demo_id }} {
    font-size: {{ block.settings.subtitle_size }}px;
    color: {{ block.settings.subtitle_color }};
    margin: 0;
    line-height: 1.5;
    max-width: 600px;
    margin: 0 auto;
  }

  .fabric-swatches-{{ demo_id }} {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: {{ block.settings.swatch_gap }}px;
    margin-bottom: {{ block.settings.section_spacing }}px;
  }

  .fabric-swatch-{{ demo_id }} {
    background: {{ block.settings.swatch_bg }};
    border-radius: {{ block.settings.swatch_border_radius }}px;
    padding: {{ block.settings.swatch_padding }}px;
    border: 2px solid {{ block.settings.swatch_border }};
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .fabric-swatch-{{ demo_id }}:hover {
    transform: translateY(-{{ block.settings.swatch_hover_lift }}px);
    border-color: {{ block.settings.swatch_hover_border }};
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
  }

  .fabric-swatch-{{ demo_id }}.active {
    border-color: {{ block.settings.swatch_active_border }};
    box-shadow: 0 0 0 3px {{ block.settings.swatch_active_glow }};
  }

  .swatch-visual-{{ demo_id }} {
    height: {{ block.settings.swatch_height }}px;
    background: linear-gradient(45deg, {{ block.settings.fabric_primary }}, {{ block.settings.fabric_secondary }});
    border-radius: 8px;
    margin-bottom: {{ block.settings.content_spacing }}px;
    position: relative;
    overflow: hidden;
  }

  .swatch-visual-{{ demo_id }}::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    opacity: 0.3;
  }

  .swatch-info-{{ demo_id }} {
    text-align: center;
  }

  .swatch-title-{{ demo_id }} {
    font-size: {{ block.settings.swatch_title_size }}px;
    font-weight: {{ block.settings.swatch_title_weight }};
    color: {{ block.settings.swatch_title_color }};
    margin: 0 0 8px 0;
    line-height: 1.3;
  }

  .swatch-description-{{ demo_id }} {
    font-size: {{ block.settings.swatch_description_size }}px;
    color: {{ block.settings.swatch_description_color }};
    margin: 0;
    line-height: 1.5;
  }

  .fabric-details-{{ demo_id }} {
    background: {{ block.settings.details_bg }};
    border-radius: 12px;
    padding: 32px;
    margin-top: {{ block.settings.section_spacing }}px;
    opacity: 0;
    animation: fadeInDetails 0.5s ease-out forwards;
  }

  .detail-header-{{ demo_id }} {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 24px;
  }

  .detail-icon-{{ demo_id }} {
    width: 48px;
    height: 48px;
    background: {{ block.settings.detail_icon_bg }};
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: {{ block.settings.detail_icon_color }};
    flex-shrink: 0;
  }

  .detail-title-{{ demo_id }} {
    font-size: 24px;
    font-weight: 600;
    color: {{ block.settings.detail_title_color }};
    margin: 0;
  }

  .detail-content-{{ demo_id }} {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 24px;
  }

  .detail-item-{{ demo_id }} {
    background: {{ block.settings.detail_item_bg }};
    padding: 20px;
    border-radius: 8px;
    border-left: 4px solid {{ block.settings.detail_accent }};
  }

  .detail-item-title-{{ demo_id }} {
    font-size: 16px;
    font-weight: 600;
    color: {{ block.settings.detail_item_title_color }};
    margin: 0 0 8px 0;
  }

  .detail-item-text-{{ demo_id }} {
    font-size: 14px;
    color: {{ block.settings.detail_item_text_color }};
    margin: 0;
    line-height: 1.5;
  }

  @keyframes fadeInDetails {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .loading-spinner-{{ demo_id }} {
    width: 20px;
    height: 20px;
    border: 2px solid {{ block.settings.spinner_bg }};
    border-top: 2px solid {{ block.settings.spinner_color }};
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  @media screen and (max-width: 749px) {
    .fabric-swatches-{{ demo_id }} {
      grid-template-columns: 1fr;
      gap: {{ block.settings.swatch_gap | times: 0.5 }}px;
    }

    .fabric-demo-{{ demo_id }} {
      padding: {{ block.settings.padding | times: 0.8 }}px 20px;
    }

    .detail-content-{{ demo_id }} {
      grid-template-columns: 1fr;
      gap: 16px;
    }

    .detail-header-{{ demo_id }} {
      flex-direction: column;
      text-align: center;
    }
  }
{% endstyle %}

<div class="fabric-demo-{{ demo_id }}" {{ block.shopify_attributes }}>
  <div class="fabric-demo-container-{{ demo_id }}">
    <div class="fabric-demo-header-{{ demo_id }}">
      {% if block.settings.title != blank %}
        <h2 class="fabric-demo-title-{{ demo_id }}">{{ block.settings.title }}</h2>
      {% endif %}

      {% if block.settings.subtitle != blank %}
        <p class="fabric-demo-subtitle-{{ demo_id }}">{{ block.settings.subtitle }}</p>
      {% endif %}
    </div>

    <div class="fabric-swatches-{{ demo_id }}">
      {% for fabric in block.settings.fabrics %}
        <div class="fabric-swatch-{{ demo_id }}" data-fabric="{{ forloop.index }}">
          <div
            class="swatch-visual-{{ demo_id }}"
            style="background: linear-gradient(45deg, {{ fabric.primary_color }}, {{ fabric.secondary_color }});"
          ></div>
          <div class="swatch-info-{{ demo_id }}">
            <h3 class="swatch-title-{{ demo_id }}">{{ fabric.name }}</h3>
            <p class="swatch-description-{{ demo_id }}">{{ fabric.short_description }}</p>
          </div>
        </div>
      {% endfor %}
    </div>

    <div class="fabric-details-{{ demo_id }}" id="fabric-details-{{ demo_id }}">
      <div class="detail-header-{{ demo_id }}">
        <div class="detail-icon-{{ demo_id }}">
          <svg
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"/>
            <line x1="16" y1="8" x2="2" y2="22"/>
            <line x1="17.5" y1="15" x2="9" y2="15"/>
          </svg>
        </div>
        <h3 class="detail-title-{{ demo_id }}" id="detail-title-{{ demo_id }}">Click on a fabric to learn more</h3>
      </div>

      <div class="detail-content-{{ demo_id }}" id="detail-content-{{ demo_id }}">
        <div class="detail-item-{{ demo_id }}">
          <h4 class="detail-item-title-{{ demo_id }}">Composition</h4>
          <p class="detail-item-text-{{ demo_id }}" id="fabric-composition-{{ demo_id }}">
            Select a fabric to see details
          </p>
        </div>
        <div class="detail-item-{{ demo_id }}">
          <h4 class="detail-item-title-{{ demo_id }}">Benefits</h4>
          <p class="detail-item-text-{{ demo_id }}" id="fabric-benefits-{{ demo_id }}">
            Select a fabric to see details
          </p>
        </div>
        <div class="detail-item-{{ demo_id }}">
          <h4 class="detail-item-title-{{ demo_id }}">Care Instructions</h4>
          <p class="detail-item-text-{{ demo_id }}" id="fabric-care-{{ demo_id }}">Select a fabric to see details</p>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const demo = document.querySelector('.fabric-demo-{{ demo_id }}');
    if (!demo) return;

    const swatches = demo.querySelectorAll('.fabric-swatch-{{ demo_id }}');
    const detailTitle = demo.querySelector('#detail-title-{{ demo_id }}');
    const detailContent = demo.querySelector('#detail-content-{{ demo_id }}');
    const composition = demo.querySelector('#fabric-composition-{{ demo_id }}');
    const benefits = demo.querySelector('#fabric-benefits-{{ demo_id }}');
    const care = demo.querySelector('#fabric-care-{{ demo_id }}');

    // Fabric data from settings
    const fabrics = {{ block.settings.fabrics | json }};

    swatches.forEach((swatch, index) => {
      swatch.addEventListener('click', function() {
        // Remove active class from all swatches
        swatches.forEach(s => s.classList.remove('active'));
        // Add active class to clicked swatch
        this.classList.add('active');

        // Update details
        const fabric = fabrics[index];
        if (fabric) {
          detailTitle.textContent = fabric.name + ' - Technical Details';
          composition.textContent = fabric.composition;
          benefits.textContent = fabric.benefits;
          care.textContent = fabric.care;

          // Animate details
          const details = demo.querySelector('.fabric-details-{{ demo_id }}');
          details.style.animation = 'none';
          setTimeout(() => {
            details.style.animation = 'fadeInDetails 0.5s ease-out forwards';
          }, 10);
        }
      });
    });

    // Add loading state for initial interaction
    let firstClick = true;
    swatches.forEach(swatch => {
      swatch.addEventListener('click', function() {
        if (firstClick) {
          // Simulate loading (remove this in production)
          setTimeout(() => {
            firstClick = false;
          }, 300);
        }
      });
    });
  });
</script>

{% schema %}
{
  "name": "Interactive Fabric Demo",
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "max_width",
      "min": 800,
      "max": 1400,
      "step": 100,
      "unit": "px",
      "label": "Maximum Width",
      "default": 1200
    },
    {
      "type": "range",
      "id": "padding",
      "min": 20,
      "max": 100,
      "step": 10,
      "unit": "px",
      "label": "Section Padding",
      "default": 60
    },
    {
      "type": "header",
      "content": "Header"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "default": "Experience Our Premium Fabrics"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "Section Subtitle",
      "default": "Click on any fabric to explore its unique properties, benefits, and care instructions"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#f9fafb"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title Color",
      "default": "#111827"
    },
    {
      "type": "range",
      "id": "title_size",
      "min": 20,
      "max": 48,
      "step": 2,
      "unit": "px",
      "label": "Title Size",
      "default": 32
    },
    {
      "type": "select",
      "id": "title_weight",
      "label": "Title Weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi Bold"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "600"
    },
    {
      "type": "color",
      "id": "subtitle_color",
      "label": "Subtitle Color",
      "default": "#6b7280"
    },
    {
      "type": "range",
      "id": "subtitle_size",
      "min": 14,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Subtitle Size",
      "default": 16
    },
    {
      "type": "header",
      "content": "Fabric Swatches"
    },
    {
      "type": "range",
      "id": "swatch_height",
      "min": 120,
      "max": 200,
      "step": 10,
      "unit": "px",
      "label": "Swatch Height",
      "default": 150
    },
    {
      "type": "range",
      "id": "swatch_gap",
      "min": 16,
      "max": 48,
      "step": 4,
      "unit": "px",
      "label": "Swatch Gap",
      "default": 24
    },
    {
      "type": "range",
      "id": "swatch_padding",
      "min": 16,
      "max": 32,
      "step": 4,
      "unit": "px",
      "label": "Swatch Padding",
      "default": 20
    },
    {
      "type": "range",
      "id": "swatch_border_radius",
      "min": 0,
      "max": 24,
      "step": 2,
      "unit": "px",
      "label": "Swatch Border Radius",
      "default": 12
    },
    {
      "type": "color",
      "id": "swatch_bg",
      "label": "Swatch Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "swatch_border",
      "label": "Swatch Border",
      "default": "#e5e7eb"
    },
    {
      "type": "color",
      "id": "swatch_hover_border",
      "label": "Swatch Hover Border",
      "default": "#d1d5db"
    },
    {
      "type": "color",
      "id": "swatch_active_border",
      "label": "Swatch Active Border",
      "default": "#3b82f6"
    },
    {
      "type": "color",
      "id": "swatch_active_glow",
      "label": "Swatch Active Glow",
      "default": "rgba(59, 130, 246, 0.3)"
    },
    {
      "type": "range",
      "id": "swatch_hover_lift",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Swatch Hover Lift",
      "default": 8
    },
    {
      "type": "color",
      "id": "fabric_primary",
      "label": "Default Fabric Primary",
      "default": "#e5e7eb"
    },
    {
      "type": "color",
      "id": "fabric_secondary",
      "label": "Default Fabric Secondary",
      "default": "#d1d5db"
    },
    {
      "type": "range",
      "id": "swatch_title_size",
      "min": 16,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Swatch Title Size",
      "default": 18
    },
    {
      "type": "select",
      "id": "swatch_title_weight",
      "label": "Swatch Title Weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi Bold"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "600"
    },
    {
      "type": "color",
      "id": "swatch_title_color",
      "label": "Swatch Title Color",
      "default": "#111827"
    },
    {
      "type": "range",
      "id": "swatch_description_size",
      "min": 12,
      "max": 16,
      "step": 1,
      "unit": "px",
      "label": "Swatch Description Size",
      "default": 14
    },
    {
      "type": "color",
      "id": "swatch_description_color",
      "label": "Swatch Description Color",
      "default": "#6b7280"
    },
    {
      "type": "header",
      "content": "Details Panel"
    },
    {
      "type": "color",
      "id": "details_bg",
      "label": "Details Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "detail_icon_bg",
      "label": "Detail Icon Background",
      "default": "#f3f4f6"
    },
    {
      "type": "color",
      "id": "detail_icon_color",
      "label": "Detail Icon Color",
      "default": "#6b7280"
    },
    {
      "type": "color",
      "id": "detail_title_color",
      "label": "Detail Title Color",
      "default": "#111827"
    },
    {
      "type": "color",
      "id": "detail_item_bg",
      "label": "Detail Item Background",
      "default": "#f9fafb"
    },
    {
      "type": "color",
      "id": "detail_accent",
      "label": "Detail Accent Color",
      "default": "#10b981"
    },
    {
      "type": "color",
      "id": "detail_item_title_color",
      "label": "Detail Item Title Color",
      "default": "#111827"
    },
    {
      "type": "color",
      "id": "detail_item_text_color",
      "label": "Detail Item Text Color",
      "default": "#6b7280"
    },
    {
      "type": "color",
      "id": "spinner_bg",
      "label": "Loading Spinner Background",
      "default": "#e5e7eb"
    },
    {
      "type": "color",
      "id": "spinner_color",
      "label": "Loading Spinner Color",
      "default": "#3b82f6"
    },
    {
      "type": "header",
      "content": "Fabric Data"
    },
    {
      "type": "textarea",
      "id": "fabrics",
      "label": "Fabrics (JSON format)",
      "info": "Enter fabric data in JSON format with: name, short_description, primary_color, secondary_color, composition, benefits, care",
      "default": "[{\"name\":\"Premium Performance\",\"short_description\":\"Our signature moisture-wicking fabric\",\"primary_color\":\"#3b82f6\",\"secondary_color\":\"#1e40af\",\"composition\":\"74% Nylon, 26% Spandex\",\"benefits\":\"Superior moisture management, four-way stretch, quick-drying\",\"care\":\"Machine wash cold, tumble dry low, no bleach\"},{\"name\":\"Soft Comfort\",\"short_description\":\"Ultra-soft fabric for all-day comfort\",\"primary_color\":\"#f59e0b\",\"secondary_color\":\"#d97706\",\"composition\":\"78% Nylon, 22% Spandex\",\"benefits\":\"Buttery soft feel, excellent stretch recovery, lightweight\",\"care\":\"Machine wash cold, air dry, no iron\"},{\"name\":\"Durable Strength\",\"short_description\":\"Built to last through intense workouts\",\"primary_color\":\"#10b981\",\"secondary_color\":\"#059669\",\"composition\":\"76% Nylon, 24% Spandex\",\"benefits\":\"Enhanced durability, shape retention, pill-resistant\",\"care\":\"Machine wash cold, tumble dry low, no bleach\"}]"
    },
    {
      "type": "range",
      "id": "content_spacing",
      "min": 8,
      "max": 24,
      "step": 2,
      "unit": "px",
      "label": "Content Spacing",
      "default": 16
    },
    {
      "type": "range",
      "id": "section_spacing",
      "min": 20,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Section Spacing",
      "default": 40
    }
  ],
  "presets": [
    {
      "name": "Interactive Fabric Demo"
    }
  ]
}
{% endschema %}
